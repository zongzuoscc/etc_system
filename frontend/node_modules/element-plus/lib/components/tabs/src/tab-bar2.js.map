{"version":3,"file":"tab-bar2.js","sources":["../../../../../../packages/components/tabs/src/tab-bar.vue"],"sourcesContent":["<template>\n  <div\n    v-if=\"renderActiveBar\"\n    ref=\"barRef\"\n    :class=\"[ns.e('active-bar'), ns.is(rootTabs!.props.tabPosition)]\"\n    :style=\"barStyle\"\n  />\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, inject, nextTick, onBeforeUnmount, ref, watch } from 'vue'\nimport { useResizeObserver } from '@vueuse/core'\nimport { capitalize, isUndefined, throwError } from '@element-plus/utils'\nimport { useNamespace } from '@element-plus/hooks'\nimport { tabsRootContextKey } from './constants'\nimport { tabBarProps } from './tab-bar'\n\nimport type { CSSProperties } from 'vue'\n\nconst COMPONENT_NAME = 'ElTabBar'\ndefineOptions({\n  name: COMPONENT_NAME,\n})\nconst props = defineProps(tabBarProps)\n\nconst rootTabs = inject(tabsRootContextKey)\nif (!rootTabs) throwError(COMPONENT_NAME, '<el-tabs><el-tab-bar /></el-tabs>')\n\nconst ns = useNamespace('tabs')\n\nconst barRef = ref<HTMLDivElement>()\nconst barStyle = ref<CSSProperties>()\n/**\n * when defaultValue is not set, the bar is always shown.\n *\n * when defaultValue is set, the bar will be hidden until style is calculated\n * to avoid the bar showing in the wrong position on initial render.\n */\nconst renderActiveBar = computed(\n  () =>\n    isUndefined(rootTabs.props.defaultValue) ||\n    Boolean(barStyle.value?.transform)\n)\n\nconst getBarStyle = (): CSSProperties => {\n  let offset = 0\n  let tabSize = 0\n\n  const sizeName = ['top', 'bottom'].includes(rootTabs.props.tabPosition)\n    ? 'width'\n    : 'height'\n  const sizeDir = sizeName === 'width' ? 'x' : 'y'\n  const position = sizeDir === 'x' ? 'left' : 'top'\n\n  props.tabs.every((tab) => {\n    if (isUndefined(tab.paneName)) return false\n    const $el = props.tabRefs[tab.paneName]\n    if (!$el) return false\n\n    if (!tab.active) {\n      return true\n    }\n\n    offset = $el[`offset${capitalize(position)}`]\n    tabSize = $el[`client${capitalize(sizeName)}`]\n\n    const tabStyles = window.getComputedStyle($el)\n\n    if (sizeName === 'width') {\n      tabSize -=\n        Number.parseFloat(tabStyles.paddingLeft) +\n        Number.parseFloat(tabStyles.paddingRight)\n      offset += Number.parseFloat(tabStyles.paddingLeft)\n    }\n    return false\n  })\n\n  return {\n    [sizeName]: `${tabSize}px`,\n    transform: `translate${capitalize(sizeDir)}(${offset}px)`,\n  }\n}\n\nconst update = () => (barStyle.value = getBarStyle())\n\nconst tabObservers = [] as ReturnType<typeof useResizeObserver>[]\nconst observerTabs = () => {\n  tabObservers.forEach((observer) => observer.stop())\n  tabObservers.length = 0\n\n  Object.values(props.tabRefs).forEach((tab) => {\n    tabObservers.push(useResizeObserver(tab, update))\n  })\n}\n\nwatch(\n  () => props.tabs,\n  async () => {\n    await nextTick()\n    update()\n\n    observerTabs()\n  },\n  { immediate: true }\n)\nconst barObserver = useResizeObserver(barRef, () => update())\n\nonBeforeUnmount(() => {\n  tabObservers.forEach((observer) => observer.stop())\n  tabObservers.length = 0\n  barObserver.stop()\n})\n\ndefineExpose({\n  /** @description tab root html element */\n  ref: barRef,\n  /** @description method to manually update tab bar style */\n  update,\n})\n</script>\n"],"names":["inject","tabsRootContextKey","throwError","ref","computed","isUndefined","capitalize","useResizeObserver","watch","nextTick","onBeforeUnmount","_unref","_openBlock","_createElementBlock"],"mappings":";;;;;;;;;;;;;;;uCAoBc,CAAA;AAAA,EACZ,IAAM,EAAA,cAAA;AACR;;;;;;AAGA,IAAM,MAAA,QAAA,GAAWA,WAAOC,4BAAkB,CAAA,CAAA;AAC1C,IAAA,IAAI,CAAC,QAAA;AAEL,MAAMC,+BAAwB,EAAA,mCAAA,CAAA,CAAA;AAE9B,IAAA,MAAM,uBAA6B,CAAA,MAAA,CAAA,CAAA;AACnC,IAAA,MAAM,gBAA8B,EAAA,CAAA;AAOpC,IAAA,MAAM,QAAkB,GAAAC,OAAA,EAAA,CAAA;AAAA,IACtB,MAAA,eACuB,GAAAC,YAAA,CAAA;AACY,MACrC,IAAA,EAAA,CAAA;AAEA,MAAA,wBAAoB,CAAqB,QAAA,CAAA,KAAA,CAAA,YAAA,CAAA,IAAA,OAAA,CAAA,CAAA,EAAA,GAAA,QAAA,CAAA,KAAA,KAAA,IAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,SAAA,CAAA,CAAA;AACvC,KAAA,CAAA,CAAA;AACA,IAAA,MAAI,WAAU,GAAA,MAAA;AAEd,MAAM,IAAA,MAAA,GAAA,CAAA,CAAA;AAGN,MAAM,IAAA,OAAA,GAAA,CAAA,CAAU;AAChB,MAAM,MAAA,QAAA,GAAW,CAAY,KAAA,EAAA,QAAA,CAAA,CAAM,QAAS,CAAA,QAAA,CAAA,KAAA,CAAA,WAAA,CAAA,GAAA,OAAA,GAAA,QAAA,CAAA;AAE5C,MAAM,MAAA,OAAW,GAAA,QAAS,KAAA,OAAA,GAAA,GAAA,GAAA,GAAA,CAAA;AACxB,MAAA,MAAI,QAAY,GAAA,OAAY,KAAA,GAAG,GAAO,MAAA,GAAA,KAAA,CAAA;AACtC,MAAA,KAAA,CAAA,IAAY,CAAA,KAAA,CAAA,CAAA,GAAc,KAAA;AAC1B,QAAI,IAAAC,iBAAa,CAAA,GAAA,CAAA,QAAA,CAAA;AAEjB,UAAI,OAAK,KAAQ,CAAA;AACf,QAAO,MAAA,GAAA,GAAA,KAAA,CAAA,OAAA,CAAA,GAAA,CAAA,QAAA,CAAA,CAAA;AAAA,QACT,IAAA,CAAA,GAAA;AAEA,UAAA,OAAS,KAAI,CAAA;AACb,QAAA,IAAA,CAAA,GAAA,CAAA,MAAc,EAAA;AAEd,UAAM,OAAA,IAAA,CAAA;AAEN,SAAA;AACE,QACE,MAAA,GAAA,GAAA,CAAA,CAAA,MAAO,oBAAqB,CAAA,QAAA,CAAA,CAAA,CAAA,CAAA,CAAA;AAE9B,QAAU,OAAA,GAAA,GAAA,CAAA,CAAA,MAAkB,EAAAC,kBAAA,CAAA,QAAqB,CAAA,CAAA,CAAA,CAAA,CAAA;AAAA,QACnD,MAAA,SAAA,GAAA,MAAA,CAAA,gBAAA,CAAA,GAAA,CAAA,CAAA;AACA,QAAO,IAAA,QAAA,KAAA,OAAA,EAAA;AAAA,UACR,OAAA,IAAA,MAAA,CAAA,UAAA,CAAA,SAAA,CAAA,WAAA,CAAA,GAAA,MAAA,CAAA,UAAA,CAAA,SAAA,CAAA,YAAA,CAAA,CAAA;AAED,UAAO,MAAA,IAAA,MAAA,CAAA,UAAA,CAAA,SAAA,CAAA,WAAA,CAAA,CAAA;AAAA,SACJ;AAAqB,QACtB,YAAuB,CAAA;AAA6B,OACtD,CAAA,CAAA;AAAA,MACF,OAAA;AAEA,QAAA,CAAA,QAAe,GAAA,CAAA,EAAA,OAAgB,CAAA,EAAA,CAAA;AAE/B,QAAA,qBAAsB,EAAAA,kBAAA,CAAA,OAAA,CAAA,CAAA,CAAA,EAAA,MAAA,CAAA,GAAA,CAAA;AACtB,OAAA,CAAA;AACE,KAAA,CAAA;AACA,IAAA,MAAA,MAAA,GAAa,MAAS,QAAA,CAAA,KAAA,GAAA,WAAA,EAAA,CAAA;AAEtB,IAAA,MAAA,YAAoB,GAAA,EAAA,CAAA;AAClB,IAAA,MAAA,YAAkB,GAAA,MAAA;AAA8B,MAClD,YAAC,CAAA,OAAA,CAAA,CAAA,QAAA,KAAA,QAAA,CAAA,IAAA,EAAA,CAAA,CAAA;AAAA,MACH,YAAA,CAAA,MAAA,GAAA,CAAA,CAAA;AAEA,MAAA,MAAA,CAAA,MAAA,CAAA,KAAA,CAAA,OAAA,CAAA,CAAA,OAAA,CAAA,CAAA,GAAA,KAAA;AAAA,oBACc,CAAA,IAAA,CAAAC,sBAAA,CAAA,GAAA,EAAA,MAAA,CAAA,CAAA,CAAA;AAAA,OACA,CAAA,CAAA;AACV,KAAA,CAAA;AACA,IAAOC,SAAA,CAAA,MAAA,KAAA,CAAA,IAAA,EAAA,YAAA;AAEP,MAAa,MAAAC,YAAA,EAAA,CAAA;AAAA,MACf,MAAA,EAAA,CAAA;AAAA,MACA,cAAkB,CAAA;AAAA,KACpB,EAAA,EAAA,SAAA,EAAA,IAAA,EAAA,CAAA,CAAA;AACA,IAAA,MAAM,WAAc,GAAAF,sBAAA,CAAkB,MAAQ,EAAA,MAAM,QAAQ,CAAA,CAAA;AAE5D,IAAAG,mBAAA,CAAgB,MAAM;AACpB,MAAA,YAAA,CAAa,OAAQ,CAAA,CAAC,QAAa,KAAA,QAAA,CAAS,MAAM,CAAA,CAAA;AAClD,MAAA,YAAA,CAAa,MAAS,GAAA,CAAA,CAAA;AACtB,MAAA,WAAA,CAAY,IAAK,EAAA,CAAA;AAAA,KAClB,CAAA,CAAA;AAED,IAAa,MAAA,CAAA;AAAA,MAAA,GAAA,EAAA,MAAA;AAAA,MAEX,MAAK;AAAA,KAAA,CAAA,CAAA;AAAA,IAEL,OAAA,CAAA,IAAA,EAAA,MAAA,KAAA;AAAA,MACD,OAAAC,SAAA,CAAA,eAAA,CAAA,IAAAC,aAAA,EAAA,EAAAC,sBAAA,CAAA,KAAA,EAAA;;;;;;;;;;;;;;"}